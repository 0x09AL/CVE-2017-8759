rule generic_OOXML_ppaction_ole {
  meta:
    author = "David Cannings & Rich Warren"
    decription = "OOXML presentation with OLE Verb Open action (could be exploiting CVE-2017-8759 or CVE-2017-0199)"
    
  strings:
    $root = "<?xml" wide ascii
    $schema_01 = "schemas.openxmlformats.org" wide ascii
    $schema_02 = "officeDocument/2006/relationships" wide ascii
    
    $action_sucpicious = /action\s*=\s*["']?ppaction:[\\\/]{2}(ole)\?verb=0/ wide ascii
    
  condition:
    $root and any of ($schema*) and $action_suspicious
}
